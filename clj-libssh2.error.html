<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>clj-libssh2.error documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-libssh2</span> <span class="project-version">0.1.72</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-libssh2</span></div></div></li><li class="depth-2 branch"><a href="clj-libssh2.agent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>agent</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.authentication.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authentication</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-2 branch current"><a href="clj-libssh2.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.known-hosts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>known-hosts</span></div></a></li><li class="depth-2"><a href="clj-libssh2.libssh2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>libssh2</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.agent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>agent</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.keepalive.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keepalive</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.knownhost.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>knownhost</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.scp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scp</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3"><a href="clj-libssh2.libssh2.userauth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>userauth</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.session.html"><div class="inner"><span class="tree" style="top: -238px;"><span class="top" style="height: 247px;"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.socket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>socket</span></div></a></li><li class="depth-2"><a href="clj-libssh2.ssh.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ssh</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clj-libssh2.error.html#var-error-messages"><div class="inner"><span>error-messages</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-get-timeout"><div class="inner"><span>get-timeout</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-handle-errors"><div class="inner"><span>handle-errors</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-maybe-throw-error"><div class="inner"><span>maybe-throw-error</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-session-error-message"><div class="inner"><span>session-error-message</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-set-timeout"><div class="inner"><span>set-timeout</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-timeouts"><div class="inner"><span>timeouts</span></div></a></li><li class="depth-1"><a href="clj-libssh2.error.html#var-with-timeout"><div class="inner"><span>with-timeout</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">clj-libssh2.error</h1><div class="doc"><pre class="plaintext">Utility functions for making error handling easier when calling native
functions.</pre></div><div class="public anchor" id="var-error-messages"><h3>error-messages</h3><div class="usage"></div><div class="doc"><pre class="plaintext">All of the error codes that are documented for libssh2 except for
LIBSSH2_ERROR_SOCKET_NONE which despite its name is a generic error and
LIBSSH2_ERROR_EAGAIN which is almost never actually an error.

These are fallback error messages for when a more appropriate one is not
available from libssh2_session_last_error().</pre></div></div><div class="public anchor" id="var-get-timeout"><h3>get-timeout</h3><div class="usage"><code>(get-timeout name-or-value)</code></div><div class="doc"><pre class="plaintext">Get a timeout value.

Arguments:

name-or-value Either the name of a symbolic timeout (e.g. :session) or a
              number of milliseconds.

Return:

A number of milliseconds for the timeout.</pre></div></div><div class="public anchor" id="var-handle-errors"><h3>handle-errors</h3><h4 class="type">macro</h4><div class="usage"><code>(handle-errors session &amp; body)</code></div><div class="doc"><pre class="plaintext">Run some code that might return a negative number to indicate an error.
Raise an exception if this happens.

Arguments:

session A clj-libssh2.session.Session which can be used to generate better
        error messages via session-error-message. This may be nil, in which
        case more generic error messages will be used.

Return:

The return value of the body, *except* in cases where it&apos;s a negative number
(but not equal to LIBSSH2_ERROR_EAGAIN). In those cases an exception will be
thrown using maybe-throw-error.</pre></div></div><div class="public anchor" id="var-maybe-throw-error"><h3>maybe-throw-error</h3><div class="usage"><code>(maybe-throw-error session error-code)</code></div><div class="doc"><pre class="plaintext">Convert an error return from a native function call into an exception, if
it&apos;s warranted.

Arguments:

session    The clj-libssh2.session.Session object for the session where the
           error may have occurred.
error-code An integer return code from a native function.

Return:

Nil if the return code was positive or if the return code was equal to
LIBSSH2_ERROR_EAGAIN. In all other cases an exception is thrown using
ex-info. The message of the exception is the best available message,
preferring the message from session-error-message, falling back to the
matching message in error-messages and finally falling back to a generic
message containing the numeric value of the error. The additional
information map attached using ex-info has the following keys and values
which may be useful to debug the error handling itself:

:error         The error message from error-messages, if any.
:session-error The error message from session-error-message, if any.
:error-code    The numeric return value.</pre></div></div><div class="public anchor" id="var-session-error-message"><h3>session-error-message</h3><div class="usage"><code>(session-error-message session)</code></div><div class="doc"><pre class="plaintext">Call libssh2_session_last_error and return the error message given or nil if
there was no error.

Arguments:

session The clj-libssh2.session.Session object for the session where the
        error occurred.

Return:

The message from libssh2_session_last_error or nil if an error message is
available and the provided session was not nil.</pre></div></div><div class="public anchor" id="var-set-timeout"><h3>set-timeout</h3><div class="usage"><code>(set-timeout timeout-name millis)</code></div><div class="doc"><pre class="plaintext">Update a timeout value.

Arguments:

timeout-name The name of a symbolic timeout.
millis       The number of milliseconds for that timeout.

Return:

A map of all the current symbolic timeouts.</pre></div></div><div class="public anchor" id="var-timeouts"><h3>timeouts</h3><div class="usage"></div><div class="doc"><pre class="plaintext">An atom map where the keys are keywords being the symbolic names of named
timeouts (see get-timeout/set-timeout) and the values are the number of
milliseconds for that timeout.</pre></div></div><div class="public anchor" id="var-with-timeout"><h3>with-timeout</h3><h4 class="type">macro</h4><div class="usage"><code>(with-timeout timeout &amp; body)</code></div><div class="doc"><pre class="plaintext">Run some code that could return libssh2/ERROR_EAGAIN and if it does, retry
until the timeout is hit. This will *not* interrupt a blocking function as
this is usually used with native functions which probably should not be
interrupted.

N.B. If the function you&apos;re calling will block in order to wait on activity
     on the current session&apos;s socket, then you should use
     clj-libssh2.socket/block instead as this will select on the socket and
     produce much better retry behaviour.

Arguments:

timeout Either a number of milliseconds or a keyword referring to a named
        timeout set using set-timeout.

Return:

Either the return value of the code being wrapped or an exception if the
timeout is exceeded.</pre></div></div></div></body></html>