<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>clj-libssh2.channel documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Clj-libssh2</span> <span class="project-version">0.1.85</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="Primary-API.html"><div class="inner"><span>The main clj-libssh2 API</span></div></a></li><li class="depth-1 "><a href="libssh2.html"><div class="inner"><span>libssh2 API</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>clj-libssh2</span></div></div></li><li class="depth-2 branch"><a href="clj-libssh2.agent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>agent</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.authentication.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>authentication</span></div></a></li><li class="depth-2 branch current"><a href="clj-libssh2.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.error.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>error</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.known-hosts.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>known-hosts</span></div></a></li><li class="depth-2"><a href="clj-libssh2.libssh2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>libssh2</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.agent.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>agent</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.channel.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>channel</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.keepalive.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>keepalive</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.knownhost.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>knownhost</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.publickey.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>publickey</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.scp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scp</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.session.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-3 branch"><a href="clj-libssh2.libssh2.sftp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sftp</span></div></a></li><li class="depth-3"><a href="clj-libssh2.libssh2.userauth.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>userauth</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.session.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>session</span></div></a></li><li class="depth-2 branch"><a href="clj-libssh2.socket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>socket</span></div></a></li><li class="depth-2"><a href="clj-libssh2.ssh.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ssh</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="clj-libssh2.channel.html#var-close"><div class="inner"><span>close</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-exec"><div class="inner"><span>exec</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-exit-signal"><div class="inner"><span>exit-signal</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-exit-status"><div class="inner"><span>exit-status</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-free"><div class="inner"><span>free</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-open"><div class="inner"><span>open</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-pull"><div class="inner"><span>pull</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-pump"><div class="inner"><span>pump</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-push"><div class="inner"><span>push</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-send-eof"><div class="inner"><span>send-eof</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-setenv"><div class="inner"><span>setenv</span></div></a></li><li class="depth-1"><a href="clj-libssh2.channel.html#var-with-channel"><div class="inner"><span>with-channel</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">clj-libssh2.channel</h1><div class="doc"><pre class="plaintext">Functions for manipulating channels within an SSH session.
</pre></div><div class="public anchor" id="var-close"><h3>close</h3><div class="usage"><code>(close session channel)</code></div><div class="doc"><pre class="plaintext">Close a channel.

Arguments:

session  The clj-libssh2.session.Session object for the current session.
channel  The channel to close.

Return:

0 on success. An exception will be thrown if an error occurs.</pre></div></div><div class="public anchor" id="var-exec"><h3>exec</h3><div class="usage"><code>(exec session channel commandline)</code></div><div class="doc"><pre class="plaintext">Execute a command on the remote host. This merely starts the execution of
the command. The input(s), output(s) and exit status of the command must be
handled separately.

Arguments:

session      The clj-libssh2.session.Session object for the current session.
channel      Execute the command via this channel.
commandline  The command to execute on the remote host.

Return:

0 on success. An exception will be thrown if an error occurs.</pre></div></div><div class="public anchor" id="var-exit-signal"><h3>exit-signal</h3><div class="usage"><code>(exit-signal session channel)</code></div><div class="doc"><pre class="plaintext">Collect the exit signal data from a channel. This will only return the
correct result after the command has completed so between calling exec and
calling this function you should sleep, wait or read the command&apos;s input as
appropriate.

Arguments:

session  The clj-libssh2.session.Session object for the current session.
channel  The channel on which a command was executed and has exited.

Return:

A map with the following keys and values:

:exit-signal The name of the signal (without the leading &quot;SIG&quot;).
:err-msg     The error message.
:lang-tag    The language tag, if provided.</pre></div></div><div class="public anchor" id="var-exit-status"><h3>exit-status</h3><div class="usage"><code>(exit-status channel)</code></div><div class="doc"><pre class="plaintext">Get the exit code from the last executed command. This will only return the
correct result after the command has completed so between calling exec and
calling this function you should sleep, wait or read the command&apos;s input as
appropriate.

Arguments:

channel  The channel on which a command was executed and has exited.

Return:

The numeric exit code from the remote process.</pre></div></div><div class="public anchor" id="var-free"><h3>free</h3><div class="usage"><code>(free session channel)</code></div><div class="doc"><pre class="plaintext">Free a native channel object. Be careful to only call this once. This will
implicitly call close if the channel has not already been closed.

Arguments:

session  The clj-libssh2.session.Session object for the current session.
channel  The native channel object to free.

Return:

0 on success or throws an exception on failure.</pre></div></div><div class="public anchor" id="var-open"><h3>open</h3><div class="usage"><code>(open session)</code></div><div class="doc"><pre class="plaintext">Create a new channel for a session.

Arguments:

session The clj-libssh2.session.Session object for the current session.

Return:

A newly-allocated channel object, or throws exception on failure.</pre></div></div><div class="public anchor" id="var-pull"><h3>pull</h3><div class="usage"><code>(pull session channel ssh-stream-id output-stream)</code></div><div class="doc"><pre class="plaintext">Read some output from a given stream on a channel.

This should probably only be called from pump.

Arguments:

session       The clj-libssh2.session.Session object for the current
              session.
channel       A valid channel for this session.
ssh-stream-id 0 for STDOUT, 1 for STDERR or any other number that the
              process on the other end wishes to send data on.
output-stream A java.io.OutputStream to send the data to.

Return:

Either :eof, :eagain or :ready. If :eof, then no more data will be sent. If
:eagain, then more data might be available. You should select on the
appropriate socket and try again. If :ready, the stream is ready for another
read immediately.</pre></div></div><div class="public anchor" id="var-pump"><h3>pump</h3><div class="usage"><code>(pump session channel input-streams output-streams)</code></div><div class="doc"><pre class="plaintext">Process a collection of input and output streams all at once. This will run
until all streams have reported EOF.

Arguments:

session        The clj-libssh2.session.Session object for the current
               session.
channel        The SSH channel that we&apos;re doing IO on.
input-streams  A map where the keys are the SSH stream IDs and the values
               are the InputStream objects used to feed those IDs.
output-streams A map where the keys are the SSH stream IDs and the values
               are the OutputStream objects used to read from those IDs.

Return:

A map where the keys are the SSH output stream IDs and the values are maps
with the following keys:

:direction       Always :output
:id              The ID of the SSH stream we&apos;re reading from.
:last-read-time  The last time the stream has been read.
:status          Always :eof
:stream          The OutputStream object connected to the SSH stream.</pre></div></div><div class="public anchor" id="var-push"><h3>push</h3><div class="usage"><code>(push session channel ssh-stream-id input-stream)</code></div><div class="doc"><pre class="plaintext">Write some input to a given stream on a channel.

This should probably only be called from pump.

Arguments:

session       The clj-libssh2.session.Session object for the current
              session.
channel       A valid channel for this session.
ssh-stream-id 0 for STDIN or any other number that the process on the other
              end wishes to receive data on.
input-stream  A java.io.PushbackInputStream to grab the data from. This must
              be capable of pushing back at least :write-chunk-size bytes.

Return:

Either :eof or :ready. If :eof, then the input-stream has returned -1 and no
more data will be read from it nor written to the channel. If :eagain, then
you should select on the appropriate socket before calling this again.  If
:ready then there are more bytes to be processed and this function should be
called again.</pre></div></div><div class="public anchor" id="var-send-eof"><h3>send-eof</h3><div class="usage"><code>(send-eof session channel)</code></div><div class="doc"><pre class="plaintext">Tell the remote process that we won&apos;t send any more input.

Arguments:

session  The clj-libssh2.session.Session object for the current session.
channel  The native channel object on which we have finished sending data.

Return:

0 on success, throws an exception on failure.</pre></div></div><div class="public anchor" id="var-setenv"><h3>setenv</h3><div class="usage"><code>(setenv session channel env)</code></div><div class="doc"><pre class="plaintext">Set a selection of environment variables on the channel. These will be
visible to the next exec command. Setting environment variables may be
prohibited by the remote sshd based on the value of the AcceptEnv
configuration value.

Arguments:

channel
env      A map where the keys are environment variable names and the values
         are the values for those environment variables. If either the name
         or value is a keyword, they will be stringified using the name
         function. Everything else will be stringified using str. Nil values
         will be converted to empty strings. For maximum predictability, you
         should provide a map of String -&gt; String only.

Return:

0 on success. Errors will result in exceptions.</pre></div></div><div class="public anchor" id="var-with-channel"><h3>with-channel</h3><h4 class="type">macro</h4><div class="usage"><code>(with-channel session channel &amp; body)</code></div><div class="doc"><pre class="plaintext">Convenience macro for wrapping a bunch of channel operations.

Arguments:

session  The clj-libssh2.session.Session object for the current session.
channel  This will be bound to the result of a call to open.</pre></div></div></div></body></html>